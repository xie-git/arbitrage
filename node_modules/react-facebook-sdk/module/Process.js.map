{"version":3,"sources":["../src/Process.jsx"],"names":["React","Component","cloneElement","PropTypes","InitFacebook","Process","state","isWorking","handleClick","evn","preventDefault","stopPropagation","setState","facebook","Error","dontWait","onResponse","onError","props","process","then","response","error","e","handleFacebookReady","onReady","getElement","children","render","component","CustomComponent","isLoading","isReady","onClick","propTypes","node","func","bool","defaultProps","undefined"],"mappings":"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","file":"Process.js","sourcesContent":["import React, { Component, cloneElement } from 'react';\nimport PropTypes from 'prop-types';\nimport InitFacebook from './InitFacebook';\n\nexport default class Process extends Component {\n  static propTypes = {\n    children: PropTypes.node,\n    render: PropTypes.func,\n    component: PropTypes.node,\n    onReady: PropTypes.func,\n    onError: PropTypes.func,\n    onResponse: PropTypes.func,\n    dontWait: PropTypes.bool,\n  };\n\n  static defaultProps = {\n    children: undefined,\n    render: undefined,\n    component: undefined,\n    onReady: undefined,\n    onError: undefined,\n    onResponse: undefined,\n    dontWait: undefined,\n  };\n\n  state = {\n    isWorking: false,\n  };\n\n  handleClick = async (evn) => {\n    evn.preventDefault();\n    evn.stopPropagation();\n\n    this.setState({\n      isWorking: true,\n    });\n\n    try {\n      const { facebook } = this.state;\n      if (!facebook) {\n        throw new Error('Facebook is not initialized');\n      }\n\n      const { dontWait, onResponse, onError } = this.props;\n      if (dontWait) {\n        this.process(facebook).then((response) => {\n          if (onResponse) {\n            onResponse(response);\n          }\n        }, (error) => {\n          if (onError) {\n            onError(error);\n          }\n        });\n      } else {\n        const response = await this.process(facebook);\n\n        if (onResponse) {\n          await onResponse(response);\n        }\n      }\n    } catch (e) {\n      const { onError } = this.props;\n      if (onError) {\n        await onError(e);\n      }\n    }\n\n    this.setState({\n      isWorking: false,\n    });\n  }\n\n  handleFacebookReady = (facebook) => {\n    this.setState({ facebook });\n\n    const { onReady } = this.props;\n    if (onReady) {\n      onReady(facebook);\n    }\n  }\n\n  getElement() {\n    const {\n      children,\n      render,\n      component: CustomComponent,\n    } = this.props;\n\n    const { facebook, isWorking } = this.state;\n    const isLoading = !facebook;\n    const isReady = !isLoading && !isWorking;\n\n    if (render) {\n      return render({\n        isWorking,\n        isLoading,\n        isReady,\n        onClick: this.handleClick,\n      });\n    }\n\n    if (CustomComponent) {\n      return (\n        <CustomComponent\n          onClick={this.handleClick}\n          isLoading={isLoading}\n          isWorking={isWorking}\n          isReady={isReady}\n        />\n      );\n    }\n\n    return cloneElement(children, {\n      onClick: this.handleClick,\n    });\n  }\n\n  render() {\n    return (\n      <InitFacebook onReady={this.handleFacebookReady}>\n        {this.getElement()}\n      </InitFacebook>\n    );\n  }\n}\n"]}